import{_ as X,a as E,b as S,c as j}from"./health-GAfT4A4A.js";import{g as A,u as q}from"./applyVendor-N7zd6jMs.js";import{b as G}from"./home-B3FaBU8H.js";import{C as J}from"./CommonHeader-D5wAUnYL.js";import{r,o as K,h as Q,s as n,c as W,a as s,b as u,w as i,d as m,u as Y,e as C,g as _,l as P,k as h,i as N}from"./index-DohTaPA9.js";import{u as Z,r as ee}from"./login-BebRebfa.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-C8QZ-v7H.js";const le="/assets/Vendor-DNdMTacI.png",se="/assets/sqcwtz-BX-qUsi7.png",oe="/assets/rzsqb-43RMBMfz.png",te={class:"applyVendor"},ue={class:"header-fixed"},de={class:"content"},ne={class:"form-card"},re={class:"form-scroll-container"},ie={class:"upload-section"},pe={class:"id-card-upload"},me={class:"id-card-upload",style:{"margin-top":"0.5rem"}},ve={class:"upload-section"},ce={class:"id-card-upload"},fe={class:"submit-btn"},be={__name:"index",setup(Ve){const U=Y(),p=Q(),l=r({stallName:"",phone:"",isVeteran:"否",isDisabled:"否"}),v=r([]),c=r([]),f=r([]),B=[{text:"是",value:"是"},{text:"否",value:"否"}],T=[{text:"是",value:"是"},{text:"否",value:"否"}],w=r([]),b=r(!1),$=o=>{l.value.isVeteran=o.selectedValues[0],V.value=!1},D=o=>{l.value.isDisabled=o.selectedValues[0],g.value=!1},V=r(!1),g=r(!1),y=r(""),I=async()=>{if(!l.value.userName){n("请填写姓名");return}if(!l.value.phone){n("请填写手机号");return}if(!l.value.idNumber){n("请填写身份证号码");return}if(!l.value.password){n("请填写密码");return}if(!y.value&&p.query.toPath!="/personalInfo"){n("请确认密码");return}if(y.value!==l.value.password&&p.query.toPath!="/personalInfo"){n("两次输入的密码不一致");return}if(!l.value.idCardFront){n("请上传身份证正面照片");return}if(!l.value.idCardBack){n("请上传身份证反面照片");return}if(!l.value.healthProve){n("请上传健康证照片");return}try{let o;p.query.toPath=="/personalInfo"?o=await Z(l.value):o=await ee(l.value),o.code===200?U.push({path:"/applyVendor/success",query:{toPath:p.query.toPath||"/home"}}):n(o.message||"提交失败")}catch(o){console.log(o,"error"),n("提交失败，请重试")}};K(async()=>{try{const{data:o}=await G("business_type");w.value=o,p.query.toPath=="/personalInfo"&&await F()}catch{n("获取数据失败")}});const F=()=>{A().then(o=>{l.value=o.data;const e=w.value.find(t=>t.dictValue==o.data.businessType);console.log(e,"businessType"),e&&(l.value.businessTypeName=e.dictLabel),c.value=[{url:`/stg${o.data.idCardBack}`}],v.value=[{url:`/stg${o.data.idCardFront}`}],f.value=[{url:`/stg${o.data.healthProve}`}]})},R=o=>{l.value.businessType=o.selectedOptions[0].value,l.value.businessTypeName=o.selectedOptions[0].text,b.value=!1},z=(o,e)=>{const t=new FormData;t.append("file",o.file),q(t).then(d=>{d.code===200?l.value.idCardFront=d.data.filePath:(v.value=[],n(d.message||"上传失败"))}).catch(d=>{v.value=[],n("上传失败")})},L=(o,e)=>{const t=new FormData;t.append("file",o.file),q(t).then(d=>{d.code===200?l.value.idCardBack=d.data.filePath:(c.value=[],n(d.message||"上传失败"))}).catch(d=>{c.value=[],n("上传失败")})},O=(o,e)=>{const t=new FormData;t.append("file",o.file),q(t).then(d=>{d.code===200?l.value.healthProve=d.data.filePath:(f.value=[],n(d.message||"上传失败"))}).catch(d=>{f.value=[],n("上传失败")})};return(o,e)=>{const t=m("van-field"),d=m("van-picker"),x=m("van-popup"),k=m("van-uploader"),M=m("van-button"),H=m("van-form");return C(),W("div",te,[s("div",ue,[u(J,{title:"申请摊主"})]),s("div",de,[e[27]||(e[27]=s("div",{class:"background-images"},[s("img",{src:le,class:"vendor-img",alt:""}),s("img",{src:se,class:"sqcwtz-img",alt:""}),s("img",{src:oe,class:"rzsqb-img",alt:""})],-1)),s("div",ne,[s("div",re,[u(H,{"input-align":"right",class:"form-container"},{default:i(()=>[u(t,{modelValue:l.value.stallName,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.stallName=a),required:"",label:"摊位名称",placeholder:"请填写您的摊位名称"},null,8,["modelValue"]),u(t,{modelValue:l.value.businessTypeName,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.businessTypeName=a),label:"经营种类",placeholder:"请选择经营种类","label-width":100,readonly:"",clickable:"",onClick:e[2]||(e[2]=a=>b.value=!0)},null,8,["modelValue"]),u(x,{show:b.value,"onUpdate:show":e[4]||(e[4]=a=>b.value=a),position:"bottom"},{default:i(()=>[u(d,{columns:w.value.map(a=>({text:a.dictLabel,value:a.dictValue})),onConfirm:R,onCancel:e[3]||(e[3]=a=>b.value=!1)},null,8,["columns"])]),_:1},8,["show"]),u(t,{modelValue:l.value.userName,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.userName=a),required:"",label:"姓名",placeholder:"请填写"},null,8,["modelValue"]),u(t,{modelValue:l.value.phone,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.phone=a),required:"",label:"手机号",placeholder:"请填写",rules:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}]},null,8,["modelValue"]),h(p).query.toPath!="/personalInfo"?(C(),_(t,{key:0,modelValue:l.value.password,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.password=a),required:"",label:"密码",type:"password",placeholder:"请填写",rules:[{required:!0,message:"请输入密码"}]},null,8,["modelValue"])):P("",!0),h(p).query.toPath!="/personalInfo"?(C(),_(t,{key:1,modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=a=>y.value=a),required:"",label:"确认密码",type:"password",placeholder:"请再次输入密码",rules:[{required:!0,message:"请确认密码"},{validator:a=>a===l.value.password,message:"两次输入的密码不一致"}]},null,8,["modelValue","rules"])):P("",!0),u(t,{modelValue:l.value.idNumber,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.idNumber=a),required:"",label:"身份证号码",placeholder:"请填写",rules:[{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"请输入正确的身份证号"}]},null,8,["modelValue"]),s("div",ie,[e[23]||(e[23]=s("div",{class:"upload-title"},[s("div",{class:"section-title required"},"上传身份证正反面"),s("div",{class:"upload-tip"},[s("img",{src:X,alt:""}),N(" 身份证照片仅用于实名认证 ")])],-1)),s("div",pe,[u(k,{modelValue:v.value,"onUpdate:modelValue":e[10]||(e[10]=a=>v.value=a),"max-count":1,"after-read":z},{default:i(()=>e[21]||(e[21]=[s("div",{class:"upload-box"},[s("img",{src:E,alt:""}),s("div",{class:"upload-text-box"},[s("div",{class:"upload-text"},"头像面"),s("div",{class:"upload-desc"},"上传您的身份证头像面")])],-1)])),_:1},8,["modelValue"])]),s("div",me,[u(k,{modelValue:c.value,"onUpdate:modelValue":e[11]||(e[11]=a=>c.value=a),"max-count":1,"after-read":L},{default:i(()=>e[22]||(e[22]=[s("div",{class:"upload-box"},[s("img",{src:S,alt:""}),s("div",{class:"upload-text-box"},[s("div",{class:"upload-text"},"国徽面"),s("div",{class:"upload-desc"},"上传您的身份证国徽面")])],-1)])),_:1},8,["modelValue"])])]),s("div",ve,[e[25]||(e[25]=s("div",{class:"upload-title"},[s("div",{class:"section-title required"},"健康证")],-1)),s("div",ce,[u(k,{modelValue:f.value,"onUpdate:modelValue":e[12]||(e[12]=a=>f.value=a),"max-count":1,"after-read":O},{default:i(()=>e[24]||(e[24]=[s("div",{class:"upload-box"},[s("img",{src:j,alt:""}),s("div",{class:"upload-text-box"},[s("div",{class:"upload-text"},"健康证"),s("div",{class:"upload-desc"},"上传您的健康证照片")])],-1)])),_:1},8,["modelValue"])])]),u(t,{modelValue:l.value.isVeteran,"onUpdate:modelValue":e[13]||(e[13]=a=>l.value.isVeteran=a),label:"是否退伍军人","label-width":100,readonly:"",clickable:"",onClick:e[14]||(e[14]=a=>V.value=!0)},null,8,["modelValue"]),u(x,{show:V.value,"onUpdate:show":e[16]||(e[16]=a=>V.value=a),position:"bottom"},{default:i(()=>[u(d,{columns:B,onConfirm:$,onCancel:e[15]||(e[15]=a=>V.value=!1)})]),_:1},8,["show"]),u(t,{modelValue:l.value.isDisabled,"onUpdate:modelValue":e[17]||(e[17]=a=>l.value.isDisabled=a),label:"是否残疾人",readonly:"",clickable:"",onClick:e[18]||(e[18]=a=>g.value=!0)},null,8,["modelValue"]),u(x,{show:g.value,"onUpdate:show":e[20]||(e[20]=a=>g.value=a),position:"bottom"},{default:i(()=>[u(d,{columns:T,onConfirm:D,onCancel:e[19]||(e[19]=a=>g.value=!1)})]),_:1},8,["show"]),s("div",fe,[u(M,{block:"",type:"primary",onClick:I},{default:i(()=>e[26]||(e[26]=[N(" 提交审核 ")])),_:1})])]),_:1})])])])])}}},Pe=ae(be,[["__scopeId","data-v-7b4160d4"]]);export{Pe as default};
